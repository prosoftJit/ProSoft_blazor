@page "/Cadastros/Fornecedor"
@using System.ComponentModel.DataAnnotations
@using ProSoft.Data

<RadzenTemplateForm TItem="fornecedor" Data="Model" Submit="Submit" id="editForm">

<DataAnnotationsValidator />
<ValidationSummary />

<RadzenRow class="mb-3">
    <RadzenColumn Size="3">
        <RadzenFormField Text="Id do Fornecedor" class="w-100">
            <RadzenNumeric Value="@Model.IdFornecedor" Format="000000" ShowUpDown=false TextAlign="TextAlign.Center" Disabled=true></RadzenNumeric>
        </RadzenFormField>
    </RadzenColumn>
    <RadzenColumn Size="9">
        <RadzenFormField Text="Nome" class="w-100">
            <RadzenTextBox @bind-Value="Model.Nome" />
            <RadzenRequiredValidator Text="Nome obrigatÃ³rio" />
        </RadzenFormField>
    </RadzenColumn>
</RadzenRow>

<RadzenRow class="mb-3">
    <RadzenColumn Size="4">
        <RadzenFormField Text="Nome Fantasia" class="w-100">
            <RadzenTextBox Value="@Model.Fantasia" />
        </RadzenFormField>
    </RadzenColumn>
    <RadzenColumn Size="4">
        <RadzenFormField Text="CNPJ" class="w-100">
            <RadzenMask Mask="**.***.***/****-**" CharacterPattern="[0-9]" @bind-Value="Model.CNPJ" />
        </RadzenFormField>
    </RadzenColumn>
</RadzenRow>
</RadzenTemplateForm>

@code {
    [Parameter] public fornecedor Model { get; set; } = new();
    [Parameter, EditorRequired] public Contexto Contexto {get;set;}

    void Submit(fornecedor forn) {
        if (forn.IdFornecedor == 0)
            Contexto.Entry(forn).State = EntityState.Added;
        else
            Contexto.Entry(forn).State = EntityState.Modified;
        Contexto.SaveChanges();
    }
}