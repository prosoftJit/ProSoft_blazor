@page "/Mercadoria"

@using System.ComponentModel.DataAnnotations
@using ProSoft.Data
@using ProSoft.Components

<EditForm Model=Model OnValidSubmit=Submit id=editForm >

    <DataAnnotationsValidator />
    <ValidationSummary Model="Model" />

    <RadzenFormField Text="Id">
        <RadzenNumeric Format="000000" TextAlign="Radzen.TextAlign.Center" Value='@Model.IdMercadoria' Disabled=true />
    </RadzenFormField>
    <RadzenFormField Text="Descrição">
        <RadzenTextBox @bind-Value="Model.Descricao" />
    </RadzenFormField>
    <RadzenFormField Text="NCM">
        <RadzenTextBox @bind-Value="Model.NCM" />
    </RadzenFormField>
    <RadzenFormField Text="Unidade">
        <RadzenTextBox @bind-Value="Model.Unidade" />
    </RadzenFormField>
    <RadzenFormField Text="Código">
        <RadzenTextBox @bind-Value="Model.Codigo" />
    </RadzenFormField>
</EditForm>

@code {
    [Parameter] public mercadoria Model { get; set; } = new();
    [Parameter, EditorRequired] public Contexto? Contexto {get;set;}
    //[Inject] NotificationService? notificationService {get;set;}
    [Parameter] public Action<string>? OnClose {get;set;} = null;

    void Submit() {
        if (Model.IdMercadoria == 0)
            Contexto!.Entry(Model).State = EntityState.Added;
        else
            Contexto!.Entry(Model).State = EntityState.Modified;
        Contexto.SaveChanges();
        //notificationService!.Notify(NotificationSeverity.Success, "Mercadoria", "Alterações feitas na mercadoria foram salvas com sucesso!");
    }
}